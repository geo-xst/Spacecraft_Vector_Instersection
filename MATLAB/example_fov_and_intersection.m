%
% DESCRIPTION
% Example script for finding the field-of-view of an instrument and also if
% a vector (with one end to an instrument) intesects any part of the 
% spacecraft. Here we are calculating the field of view of the Cassini 
% Langmuir Probe, using the Cassini .stl model as provided by NASA.
%
% INPUT:
%   - model path: a character array with the path of the spacecraft model, 
%        including the extension                                            [.obj or .stl]
%        e.g. 'C:\Users\Darth_Vader\Documents\Cassini_3D_model_example\Cassini_NASA_model.obj'
%   - [x,y,z]: the instrument's location on the model                       [model units / scale]
%   - [vector_matrix]: n x 3 matrix with the vector of interest, e.g.
%       instrument-->Sun                                                    [model units / scale]
%
% OUTPUT:
%   -  index: index of whether the given vector intersects the spacecraft
%       or not; 1 if it does, 0 if it doesn't                               [0 or 1]
%   -  phi: the phi angle of each of the vectors                            [rad] -> [-pi pi]
%   -  theta: the theta angle of each of the vectors                        [rad] -> [-pi/2 pi/2]
%
% ------------------------------------
% NOTES:
% - The units for the instruments x,y,z are the same as the model. e.g. 
% if the 1 unit of the model corresponds to 1 metre, the instrument's x,y,z
% "offset" from the s/c origin also follows this.
% - The units of the vector matrix should follow the units of the model or
% be given in normalised units
%
% ------------------------------------
% Author: George Xystouris (23 March 2023)
% ------------------------------------
% Credits: George Xystouris
%          Oleg Shebanits
%          Chris Arridge
% (this work is submitted for publishing)
% ------------------------------------
% v1

% Define the model path
model_path = 'write-the-path-to-the-model-here';

% Define the location of the Langmuir Probe on Cassini (since the
% instrument is a probe, the "location" here is given 1-2 cm in front of
% it, and not on the top of the sphere).
lp_x = -2.285;
lp_y = 0.66;
lp_z = 0.275;


% (1) CALCULATE THE FOV
fov = instr_field_of_view(lp_x, lp_y, lp_z, model_path);

% Plot the FOV as seen from the Langmuir Probe
figure;
plot(fov); hold on;
xlim([-pi,pi]); 
xticks([-pi, -pi + (pi/6), -pi + (2*pi/6), -pi/2, -pi/2 + (pi/6), -pi/2 + (2*pi/6), 0, ...
    (pi/6), (2*pi/6), pi/2, pi/2 + (pi/6), pi/2 + (2*pi/6), pi]);
xticklabels( [ {'-180'}, {'-150'}, {'-120'}, {'-90'}, {'-60'}, {'-30'}, {'0'}, ...
    {'30'}, {'60'}, {'90'}, {'120'}, {'150'}, {'180'} ] );
xlabel(['Azimuth   [ ' char(176) ' ]']);
ylim([-pi/2, pi/2]);
yticks([-pi/2, -pi/2 + (pi/6), -pi/2 + (2*pi/6), 0, pi/6, 2*pi/6, pi/2]);
yticklabels( [ {'-90'}, {'-60'}, {'-30'}, {'0'}, {'30'}, {'60'}, {'90'} ] );
ylabel(['Elevation   [ ' char(176) ' ]']);
box on; title('LP FOV');


% (2) FIND ANY INTERSECTIONS WITH SUNLIGHT OR PLASMA FLOW
%
% The following variables are the sunlight (normalised unit) vector and 
% the plasma flow vector (non-normalised) as seen from the Langmuir Probe 
% between 2007-06-11 22:00:00 and 2007-06-12 01:00:00, in one minute intervals.
% They are being used as an example on what can be done with the
% intersection script.

% Light
light_vector(:,1) = [-0.376295645817162;-0.376070066766366;-0.373175324387969;-0.362505271097798;-0.338578827523800;-0.303294652383437;-0.258250172590635;-0.218622375617333;-0.194850984207718;-0.189713857226655;-0.189714076044009;-0.189714295143942;-0.166330482380633;-0.0773417862866151;0.0395204445844361;0.0924213277273677;0.0958158701284038;0.0967590073004355;0.0976935950776640;0.0986193313853585;0.0995359127919969;0.100443034506765;0.101340390378998;0.102227672911229;0.103104573245996;0.103970781179823;0.104825985155072;0.105669872278138;0.106502128296881;0.107322437619979;0.108130483309958;0.108925947082059;0.109708509316452;0.110477849047857;0.111233643975815;0.111975570455080;0.112703303515068;0.113416516854713;0.114114882841989;0.114798072529707;0.115465755650920;0.116117600637253;0.116752461584322;0.0992866485028960;0.0268822511304140;-0.0911066641261886;-0.168776311623192;-0.189722377634957;-0.189722607719618;-0.189721960658416;-0.197625390100057;-0.231525327545455;-0.289359568797890;-0.357015248095017;-0.413643100087691;-0.447680190069257;-0.463194060921588;-0.465849239223125;-0.467288472324102;-0.468720895722166;-0.470144243523165;-0.475844715417573;-0.501147639056631;-0.545435516191061;-0.605840984981314;-0.672239586051746;-0.730140747907718;-0.777898135237691;-0.814487576485758;-0.839119568445330;-0.851256422542875;-0.850624091104372;-0.837218410508884;-0.811305615209167;-0.773417098652918;-0.724338520803402;-0.665093483196799;-0.602705071049191;-0.552971480314315;-0.520405733852100;-0.507178266468741;-0.508133043164970;-0.509637015051841;-0.511133942666504;-0.512623506764972;-0.514105382276590;-0.515579237951597;-0.517044735991099;-0.518501531659095;-0.519949272897306;-0.521387599918625;-0.522816144808968;-0.524234531077162;-0.525642373234408;-0.527039276330575;-0.528424835504270;-0.529798635510032;-0.531159872292680;-0.536810628249831;-0.562482153962088;-0.608030834937793;-0.670653103544338;-0.741235917385659;-0.803573847986354;-0.855313083457563;-0.895256702210521;-0.922430656959315;-0.936106143113962;-0.935817222851890;-0.921373290023889;-0.892866061827975;-0.850670892426479;-0.795442319076551;-0.728103870079514;-0.655553387966025;-0.596188292843098;-0.555782962089997;-0.537283253897496;-0.536776805550381;-0.537579662543272;-0.538368627254358;-0.539143603926151;-0.539904497796745;-0.540651215114803;-0.541383663122416;-0.542101750095831;-0.542805385324327;-0.543494479139797;-0.544168942930427;-0.544828689123644;-0.545473631218164;-0.548432276267426;-0.565016183435825;-0.595712254838808;-0.634939072402097;-0.672733257534327;-0.708456161418958;-0.739993445988762;-0.759358836054741;-0.767005359135170;-0.766254123151481;-0.764920015464715;-0.763581126119832;-0.762237601167499;-0.760889578866812;-0.759537189500640;-0.758180555219377;-0.756819789853596;-0.755454998729919;-0.754086278501262;-0.752713716959985;-0.751337392866201;-0.749957375743770;-0.748573725708449;-0.747186493271774;-0.745795719154513;-0.744401434113129;-0.743003658719885;-0.741602403185136;-0.740197667169489;-0.741465544343638;-0.738261959232114;-0.725742182452313;-0.701579747131629;-0.669782195375997;-0.630827480627754;-0.591953031422126;-0.566595519739233;-0.558273531061482;-0.558286209145651;-0.558282467604231;-0.552536737314356;-0.528047595894618;-0.480136581768760;-0.414493051298450;-0.341296497347407;-0.261513162212161;-0.176215228314709;-0.102269725771164;-0.0573963365069744];
light_vector(:,2) = [-0.914905301541966;-0.916918656773177;-0.923558899086555;-0.931933031050262;-0.936654198468280;-0.934539938467354;-0.925794470606218;-0.915114772982670;-0.907798466907164;-0.906143518681242;-0.906143910692540;-0.906144302942588;-0.910757816451049;-0.927749571047090;-0.937154483507450;-0.935412870687759;-0.933371627551696;-0.931357617507453;-0.929305930837286;-0.927216261062165;-0.925088300841207;-0.922921741906417;-0.920716274994372;-0.918471589743360;-0.916187374653804;-0.913863316981558;-0.911499102686030;-0.909094416307395;-0.906648940957007;-0.904162358191205;-0.901634347960380;-0.899064588543209;-0.896452756439787;-0.893798526339372;-0.891101571023023;-0.888361561339354;-0.885578166078544;-0.882751051938227;-0.879879883482757;-0.876964323041556;-0.874004030698361;-0.870998664189730;-0.867951873559839;-0.873087308489412;-0.891366528195406;-0.906649035205819;-0.907264647200284;-0.906158580299807;-0.906158981082118;-0.906158107953021;-0.904915187571624;-0.904295810804848;-0.902875382290512;-0.898215613967045;-0.890241689369551;-0.882473192189786;-0.877499274505276;-0.875649051459295;-0.874083021543528;-0.872479860150697;-0.870840922776369;-0.867705830971597;-0.854110878334816;-0.828422041244704;-0.788781169345760;-0.737409782169761;-0.683067112559336;-0.627177482453016;-0.570911353600477;-0.515449215425563;-0.461956580715199;-0.411559251675246;-0.365319382202883;-0.324212849859932;-0.289108421546829;-0.260749163108582;-0.239736493445247;-0.227261067835889;-0.222379851078058;-0.221124411299679;-0.220911026126131;-0.220727273847439;-0.220574984304734;-0.220459730872995;-0.220382298861741;-0.220343478872434;-0.220344066733688;-0.220384863428346;-0.220466675011945;-0.220590312522174;-0.220756591877349;-0.220966333768684;-0.221220363536263;-0.221519511038836;-0.221864610506507;-0.222256500383772;-0.222696023158875;-0.223183874311493;-0.217162670190888;-0.208263882795164;-0.198997787456533;-0.192468314443234;-0.192627150849995;-0.200428102194309;-0.215686711736270;-0.238103952104822;-0.267232370998584;-0.302483412278905;-0.343137700705510;-0.388358112820041;-0.437205398032895;-0.488656056083765;-0.541622130336623;-0.594972530138296;-0.643728554849788;-0.678009698309945;-0.698083694546803;-0.704715419802376;-0.701162299476166;-0.696826068143405;-0.692440375034806;-0.688005310073647;-0.683520976705770;-0.678987491986286;-0.674404986857538;-0.669773606071909;-0.665093508484212;-0.660364867018607;-0.655587868715666;-0.650762714989940;-0.645889621539080;-0.644299922089350;-0.634507039648110;-0.615208333701858;-0.590278258641576;-0.566489055471320;-0.544268723837158;-0.525012437859175;-0.513928710327156;-0.510609141146962;-0.512824445627261;-0.515448896893764;-0.518103331297599;-0.520787085896455;-0.523499488264753;-0.526239856720164;-0.529007500501681;-0.531801720019513;-0.534621807110789;-0.537467045274022;-0.540336709950759;-0.543230068784715;-0.546146381958184;-0.549084902473278;-0.552044876492624;-0.555025543672516;-0.558026137477145;-0.561045885602143;-0.564084010320316;-0.567139728857451;-0.561714676170565;-0.547402448377850;-0.526651418032162;-0.502952513698275;-0.481327113218871;-0.462175125590397;-0.446958979788671;-0.436329175870712;-0.428765225544899;-0.422340959264315;-0.415889014208404;-0.402266240074533;-0.371605663927265;-0.323800290173667;-0.268001459608232;-0.213389880173775;-0.160636062414141;-0.110393314540682;-0.0702100521148243;-0.0454381533282386];
light_vector(:,3) = [-0.146115968153553;-0.133534571342460;-0.0881994171520660;-0.00952649273256002;0.0896843913083767;0.186138274530103;0.276064207299426;0.338776045712077;0.371396065453427;0.378037796957079;0.378036747506904;0.378035697339192;0.377960805381118;0.365101330476809;0.346669307123854;0.341263914782673;0.345885420208824;0.351013792915714;0.356155090362958;0.361309054272107;0.366475425794681;0.371653945405531;0.376844352801420;0.382046386876592;0.387259785545481;0.392484285718959;0.397719623150318;0.402965532436011;0.408221746762434;0.413487997907346;0.418764016072555;0.424049529748480;0.429344265659936;0.434647948555295;0.439960301127457;0.445281043786914;0.450609894633656;0.455946569245233;0.461290780480522;0.466642238396536;0.472000649994236;0.477365719131520;0.482730160543100;0.477347581101839;0.452485421850286;0.411930944106116;0.385208276878126;0.377997416358336;0.377996340093770;0.377998757980669;0.376925335431320;0.358671310904249;0.317941950674743;0.256415333889098;0.190706896200144;0.144303542873774;0.124283084809165;0.127370424328701;0.132741685548827;0.138128981552861;0.143528664384623;0.143730295021819;0.139088645755484;0.127346061020159;0.103831439373667;0.0657324281106526;0.0177146262904184;-0.0390243090601212;-0.103296728314251;-0.173754010512837;-0.248914886283300;-0.327196635058146;-0.406948500540156;-0.486486615145551;-0.564129694398375;-0.638234738335758;-0.707231979141022;-0.764917645487200;-0.802975556161890;-0.824792014329205;-0.833047732460549;-0.832514432922207;-0.831635009597369;-0.830746411197545;-0.829848650454043;-0.828941739347606;-0.828025689002769;-0.827100509584878;-0.826166210200072;-0.825222798785233;-0.824270282003296;-0.823308665123789;-0.822337951929249;-0.821358144593218;-0.820369243578610;-0.819371247518147;-0.818364153101130;-0.817348241763164;-0.815275857654074;-0.800149974440575;-0.768569049827180;-0.716366081442811;-0.643011738254329;-0.560444151261472;-0.471082552899926;-0.376592545251771;-0.278762520780831;-0.179468866716245;-0.0806389717711676;0.0157872302007611;0.107896411278136;0.193840892566552;0.271876782664016;0.340400415328873;0.394795267445381;0.429956240185544;0.451424915637535;0.463360423616519;0.469299574703007;0.474806841963830;0.480297353948483;0.485770385733823;0.491225210735396;0.496661101075029;0.502077327715402;0.507473161016884;0.512847870849701;0.518200727085614;0.523530999982649;0.528837960330699;0.534120879982963;0.533009989347092;0.527406417379052;0.516377396463717;0.498421459923460;0.475941292848671;0.449289910414409;0.420442195773502;0.399063201519579;0.388562844383106;0.387124923920492;0.386276849723695;0.385373587486092;0.384414685632450;0.383399705996792;0.382328224127660;0.381199829617225;0.380014126408803;0.378770733103248;0.377469283280812;0.376109425805673;0.374690825146780;0.373213161667033;0.371676131941348;0.370079449051787;0.368422842888210;0.366706060466220;0.364928866188703;0.363091042151938;0.361192388441871;0.367022436815230;0.394106380385673;0.442647228042905;0.504801572282918;0.565434364747755;0.623258247414618;0.670685678225221;0.698989533037093;0.710275331036900;0.714104070010441;0.717883705224246;0.729989743773366;0.763593456629306;0.815243665986348;0.869695767537797;0.915413272755979;0.951738893521683;0.978141865689593;0.992275894987238;0.997316917924136];
[light_index, light_phi, light_theta ] = instr_sc_vector_intersection(lp_x, lp_y, lp_z, light_vector, model_path);
% Plasma
plasma_vector(:,1) = [-5.07224611464607;-5.33939590207909;-6.30630224230386;-7.90966999319866;-9.79371826312199;-11.4672316859211;-12.8700269338069;-13.7365051626409;-14.1338772221464;-14.1876319099106;-14.1580474085314;-14.1282949293513;-13.8326467896649;-12.7059133488465;-11.1173857841044;-10.3545896901199;-10.3006596984411;-10.2823044796228;-10.2639170442709;-10.2454997754560;-10.2270550258354;-10.2085851172517;-10.1900923398513;-10.1715789511350;-10.1530471755491;-10.1344992032694;-10.1159371900033;-10.0973632554920;-10.0787794835676;-10.0601879209026;-10.0415905765441;-10.0229894211639;-10.0043863861879;-9.98578336332197;-9.96718220368765;-9.94858471747051;-9.92999267272689;-9.91140779494952;-9.89283176668360;-9.87426622631305;-9.85571276795076;-9.83717294018324;-9.81867867620758;-10.0586791238623;-10.9644831893078;-12.1887490002178;-12.8204718034177;-12.9414735560965;-12.9051883509680;-12.8687215384469;-12.7232472903896;-12.2189464072486;-11.2456607511459;-9.82245713479120;-8.29941679336382;-7.19164816474448;-6.65809319644943;-6.62345413411646;-6.63697300749213;-6.64995066227530;-6.66236355446911;-6.53116818146508;-6.04282708102986;-5.18442617408738;-3.94704925464434;-2.45359117011816;-0.979207329311795;0.437424184178493;1.76743889178670;2.98387321543163;4.06222321480568;4.98095010053353;5.72192220459205;6.27078437530568;6.61724735891477;6.75529135963284;6.68327982786289;6.43584807266934;6.15358513809476;5.94213030594536;5.86382741654889;5.89610215234873;5.93291153634517;5.96985358459296;6.00692768306919;6.04413304630358;6.08146871263204;6.11893353912019;6.15652619655039;6.19424516348553;6.23208872075231;6.27005494533975;6.30814170435223;6.34634664810389;6.38466720371519;6.42310056779518;6.46164369928776;6.50029315015943;6.53133322231540;6.62761723222554;6.75071179079251;6.82009247521622;6.73214044746472;6.45064021681919;5.98342608400134;5.34231900445934;4.54263472061999;3.60282999148212;2.54408784725988;1.38985125329434;0.165315434359981;-1.10311002687861;-2.38835788450761;-3.66326692951372;-4.81785169819618;-5.64008869421016;-6.14330749091688;-6.35217531751710;-6.34337988899789;-6.31835538303523;-6.29262751697468;-6.26619498900641;-6.23905655733105;-6.21121104122948;-6.18265732083577;-6.15339433873600;-6.12342109968493;-6.09273667175929;-6.06134018722143;-6.02923084230251;-5.99640789844036;-5.88890061914050;-5.53737316392279;-4.91903735461260;-4.10128131198519;-3.25744150345740;-2.40030564769413;-1.58169394442030;-1.02204095263148;-0.751090688870669;-0.701156175356214;-0.666672327425414;-0.632226417049027;-0.597826524263056;-0.563480902236175;-0.529197983587465;-0.494986387160928;-0.460854924602068;-0.426812606698420;-0.392868650163262;-0.359032483829880;-0.325313755373091;-0.291722337567232;-0.258268334561766;-0.224962088229471;-0.191814184464656;-0.158835459099734;-0.126037003941185;-0.0934301728808737;-0.0610265872979729;-0.0984646487296779;-0.423371903016954;-1.04253553675754;-1.84034470757305;-2.60442536232383;-3.32038570566821;-3.88450994152609;-4.17425605269289;-4.22005704311466;-4.15957223700125;-4.09840048552604;-4.11166295947615;-4.31943429381577;-4.70659968338626;-5.15494805689595;-5.56351807853619;-5.93033955028720;-6.25391122162940;-6.47258236203581;-6.55126263383949];
plasma_vector(:,2) = [-5.00323430496129;-5.08129421188249;-5.60693667642709;-6.57505077026856;-7.79512762100321;-8.94874268732622;-9.98837922768052;-10.6597475149131;-10.9449587648632;-10.9076381798998;-10.7889329070198;-10.6703992135005;-10.9051812050891;-11.9221429153332;-13.0858376566750;-13.5121191261658;-13.4851639845789;-13.4365321710251;-13.3875147773562;-13.3381096297629;-13.2883146968526;-13.2381280881091;-13.1875480523695;-13.1365729772496;-13.0852013867856;-13.0334319412942;-12.9812634345939;-12.9286947949249;-12.8757250814190;-12.8223534840559;-12.7685793221156;-12.7144020424510;-12.6598212195348;-12.6048365527009;-12.5494478661692;-12.4936551063814;-12.4374583425519;-12.3808577647325;-12.3238536821455;-12.2664465228111;-12.2086368320645;-12.1504252720144;-12.0917315391316;-11.7208621284600;-10.5011505753442;-8.46989924836939;-7.01938327309469;-6.53805907154912;-6.42757014204743;-6.31738320356355;-6.18634154230932;-5.84050194398226;-5.26848609045981;-4.55816702405849;-3.89803589551357;-3.45290815647589;-3.22772087815788;-3.17290822178819;-3.13412393844630;-3.09508406327288;-3.05575702480968;-2.99388419303893;-2.97587361187474;-3.03811334133794;-3.23523716456653;-3.60061534346476;-4.08071189323754;-4.66108246255330;-5.32745149937696;-6.06377979826650;-6.85260562050813;-7.67541442957745;-8.51302946315893;-9.34601490655142;-10.1550832530576;-10.9214983117184;-11.6274654908404;-12.2017763740146;-12.5487302198846;-12.7075913905019;-12.7095431882547;-12.6099794197238;-12.5063849594596;-12.4026383685466;-12.2987325951758;-12.1946603738038;-12.0904142227122;-11.9859864416593;-11.8813691095572;-11.7765540820113;-11.6715329895799;-11.5662972352199;-11.4608379930287;-11.3551462060337;-11.2492125845385;-11.1430276049989;-11.0365815083692;-10.9298647844026;-10.8024174335066;-10.5589263948012;-10.1757843145474;-9.62462660574138;-8.91098977225617;-8.14152089707340;-7.33896187790216;-6.51891592560488;-5.69719991109752;-4.88951466398543;-4.11112148354972;-3.37653148740766;-2.69921404739535;-2.09133014123637;-1.56349578319284;-1.12458005423029;-0.797903267929861;-0.597438995002620;-0.475779173458974;-0.398724078674727;-0.344095847078566;-0.290749461678278;-0.237239243272175;-0.183569847078511;-0.129746040107615;-0.0757727014955423;-0.0216548196624218;0.0326025062657815;0.0869940695529370;0.141514555601459;0.196158542446396;0.250920504027277;0.305794809858343;0.362679445473352;0.259072726690076;-0.0312914412603322;-0.459127920591705;-0.902197817197727;-1.35160249477939;-1.77170697442481;-2.01189994571312;-2.05341985305230;-1.94337451667850;-1.82261247579174;-1.70169409059176;-1.58062172071452;-1.45939791664497;-1.33802542051114;-1.21650716769113;-1.09484628808289;-0.973046106258284;-0.851110143377764;-0.729042116804737;-0.606845941061352;-0.484525727904752;-0.362085786309239;-0.239530622428714;-0.116864939151760;0.00590636421654556;0.128778193311526;0.251745259199956;0.374802079624339;0.468657814714791;0.612032314172509;0.833948138085389;1.12773172989846;1.44596365952525;1.78359495257001;2.09473246589628;2.30609659791024;2.40982003491390;2.46381478824793;2.51767871997264;2.58997935604231;2.63468393774995;2.66305088077174;2.70469391129384;2.77259134003324;2.86535156076968;2.98138932442961;3.10265414097537;3.19917126933573];
plasma_vector(:,3) = [-20.4984456814851;-20.3048339908033;-19.7762804769842;-18.7678602491547;-17.2362685184233;-15.4259676987629;-13.4136287137382;-11.7824752175911;-10.8366315143340;-10.6110001817989;-10.5782778553024;-10.5452695481158;-10.5045813050082;-10.6301955285314;-10.8506140414245;-10.8992573976733;-10.8017566527748;-10.6973133209690;-10.5932854178959;-10.4896805474329;-10.3865063035443;-10.2837702719694;-10.1814800309732;-10.0796431516276;-9.97826719973684;-9.87735973570797;-9.77692831645882;-9.67698049486065;-9.57752382264589;-9.47856584991850;-9.38011412698690;-9.28217620526646;-9.18475963790418;-9.08787198143229;-8.99152079649828;-8.89571364983996;-8.80045811409009;-8.70576176963050;-8.61163220646109;-8.51807702402279;-8.42510383398767;-8.33272025990052;-8.24101665172808;-8.28817522358015;-8.57316030758815;-8.96977780476805;-9.16072904335946;-9.17309205061660;-9.13013005919234;-9.08689119102874;-9.21010300788112;-9.92378233428880;-11.1631648199717;-12.5915763636449;-13.7376249325119;-14.3586789792958;-14.5638946049059;-14.4908226341906;-14.3923563981142;-14.2942609515806;-14.1965600753810;-14.1708097259414;-14.2915549626357;-14.5163682528917;-14.7656710387297;-14.9113540829061;-14.8663488486932;-14.6291838856313;-14.2042036198533;-13.5996767530960;-12.8276110686877;-11.9034906998951;-10.8459415862378;-9.67633234657972;-8.41831906783183;-7.09734371369417;-5.74009674111993;-4.47892823706417;-3.54996650998331;-2.95748302102761;-2.69151661547517;-2.65179657051508;-2.62079348175935;-2.58972761610647;-2.55859790107221;-2.52740338143952;-2.49614322067168;-2.46481670248209;-2.43342323215084;-2.40196233867438;-2.37043367626588;-2.33883702637442;-2.30717229927292;-2.27543953651944;-2.24363891256503;-2.21177073720257;-2.17983545759807;-2.14783168169883;-2.24041821776731;-2.64907229454857;-3.37662842401294;-4.41388064781792;-5.65983130370058;-6.85713135247259;-7.96431563358802;-8.95849075369810;-9.81932110002174;-10.5294232682232;-11.0746947859564;-11.4445711574348;-11.6322068335429;-11.6345772887902;-11.4525011312542;-11.0905827999704;-10.5941277497273;-10.1161723228674;-9.74578685505842;-9.53426271918570;-9.46258603566925;-9.40208191924917;-9.34245487281054;-9.28371182235091;-9.22585956911121;-9.16890478589789;-9.11285401309743;-9.05771365437224;-9.00348997320550;-8.95018908857571;-8.89781697120417;-8.84637943976584;-8.79588215724625;-8.79622637605394;-8.95780921731751;-9.25111217403377;-9.56974474738479;-9.79990184991744;-9.93718253426560;-9.97944893794467;-9.95255099415298;-9.91471882155363;-9.88797200486708;-9.86170344268731;-9.83486605069245;-9.80744897608610;-9.77944144467322;-9.75083277140282;-9.72161237107964;-9.69176976952941;-9.66129461474270;-9.63017668876720;-9.59840591938810;-9.56597239221156;-9.53286636315780;-9.49907827112942;-9.46459875092421;-9.42941864620133;-9.39352902333376;-9.35692118469220;-9.31958668260372;-9.28151733399776;-9.24375699918146;-9.19401227203885;-9.09562498777691;-8.90533249965951;-8.63495525961239;-8.29003791774520;-7.93537334283060;-7.69698468971271;-7.61121809036725;-7.59981399242964;-7.58940521291643;-7.53314419088763;-7.37649553673172;-7.10211338701359;-6.74461090556015;-6.36049856806236;-5.95455799942767;-5.53160017907334;-5.18300320506508;-5.00391196372272];
[plasma_index, plasma_phi, plasma_theta ] = instr_sc_vector_intersection(lp_x, lp_y, lp_z, plasma_vector, model_path);


% Plot for incident sunlight and plasma flow
figure;
plot(fov); hold on;
s1 = scatter(light_phi,light_theta, 10, 'r', 'filled');
s2 = scatter(plasma_phi,plasma_theta, 10, 'b', 'filled');
legend([s1 s2],{'Sunshine','Plasma Flow'});
xlim([-pi,pi]); 
xticks([-pi, -pi + (pi/6), -pi + (2*pi/6), -pi/2, -pi/2 + (pi/6), -pi/2 + (2*pi/6), 0, ...
    (pi/6), (2*pi/6), pi/2, pi/2 + (pi/6), pi/2 + (2*pi/6), pi]);
xticklabels( [ {'-180'}, {'-150'}, {'-120'}, {'-90'}, {'-60'}, {'-30'}, {'0'}, ...
    {'30'}, {'60'}, {'90'}, {'120'}, {'150'}, {'180'} ] );
xlabel(['Azimuth   [ ' char(176) ' ]']);
ylim([-pi/2, pi/2]);
yticks([-pi/2, -pi/2 + (pi/6), -pi/2 + (2*pi/6), 0, pi/6, 2*pi/6, pi/2]);
yticklabels( [ {'-90'}, {'-60'}, {'-30'}, {'0'}, {'30'}, {'60'}, {'90'} ] );
ylabel(['Elevation   [ ' char(176) ' ]']);
box on; title('LP FOV');



